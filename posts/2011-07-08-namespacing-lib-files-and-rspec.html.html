<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Rubber Duck Dialogs: Namespacing lib files and RSpec</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href='http://fonts.googleapis.com/css?family=Alegreya:400italic,700italic,400,700' rel='stylesheet'
          type='text/css'>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.1/styles/default.min.css">
    <link href="../css/screen.css" rel="stylesheet" type="text/css" />
</head>
<body>


<nav class="navbar navbar-default">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/blog/index.html">Rubber Duck Dialogs</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
                <li ><a href="/blog/index.html">Home</a></li>
                <li
                ><a href="/blog/archives.html">Archives</a></li>
                
                <li><a href="/blog/feed.xml">RSS</a></li>
            </ul>
        </div><!--/.nav-collapse -->
    </div><!--/.container-fluid -->
</nav>


<div class="container">


    <div class="row">
        <div class="col-lg-9">
            <div id="content">
                
<div id="post">
    <div class="post-header">
    <div id="post-meta" class="row">
        <div class="col-lg-6">July 8, 2011</div>
        
    </div>
    <h2>Namespacing lib files and RSpec</h2>
</div>
<div>
    
    <p>I've been in an ongoing battle with RSpec to get it to properly load files in the <code>/lib</code> directory of a rails app. There's a class <code>MetalArchivesFetcher</code> wrapped in a MetalDetectr module as a namespace:</p><pre><code class="ruby">module MetalDetectr
  class MetalArchivesFetcher
    ...
  end
end
</code></pre><p>The spec file starts like this:</p><pre><code class="ruby">require 'spec&#95;helper'
require 'metal&#95;archives&#95;fetcher'

describe MetalDetectr::MetalArchivesFetcher do
  ...
end
</code></pre><p>Without the require, I would receive the message</p><pre><code class="ruby">load&#95;missing&#95;constant': Expected /Users/danny/code/metaldetectr/lib/metal&#95;archives&#95;fetcher.rb to define MetalArchivesFetcher &#40;LoadError&#41;
</code></pre><p>It felt a little off to need to require the file again because Rails already loads it in with</p><pre><code class="ruby"># config/application.rb
config.autoload&#95;paths += Dir&#91;&quot;#{config.root}/lib/&#42;&#42;/&quot;&#93;
</code></pre><p>I could put the require in <code>spec&#95;helper.rb</code>, but it still felt strange.</p><p>I decided to remove the module namespace. That lets me remove the require line and all preceding <code>MetalDetectr::</code> for every MetalArchivesFetcher call in the spec. Is this the right decision? It's definitely <a href='https://en.wikipedia.org/wiki/Don%27t&#95;repeat&#95;yourself'>DRYer</a>, but I do create tighter coupling. Jim Weirich's talk, <a href='http://mattgrande.com/2009/05/11/jim-weirich-on-connascence/'>"The Building Blocks of Modularity"</a> (that I can't find online) does go over the trade-offs of writing code that is either more tightly or loosely coupled, and my takeaway from that is, since this file is already coupled to the application and models within it, why add an additional layer? It's more of a perceived loosening while only adding a bit more complexity. And that's usually not a good thing.</p><p>Perhaps I'll add it back in later, but for now, <a href='https://en.wikipedia.org/wiki/You&#95;aren%27t&#95;gonna&#95;need&#95;it'>I'm not going to need it</a>.</p>
</div>

<div id="post-tags">
    <b>Tags: </b>
    
    <a href="/blog/tags/testing.html">testing</a>
    
    <a href="/blog/tags/modularity.html">modularity</a>
    
    <a href="/blog/tags/metaldetectr.html">metaldetectr</a>
    
    <a href="/blog/tags/rails.html">rails</a>
    
</div>


    <div id="prev-next">
        
        <a href="/blog/posts/2011-07-13-adding-field-separation-for-list-data.html.html">&laquo; Adding Field Separation for List Data</a>
        
        
        <a class="right" href="/blog/posts/2011-06-26-a-real-life-github-success-story.html.html">A Real Life GitHub Success Story &raquo;</a>
        
    </div>

    


</div>

            </div>
        </div>

        <div class="col-md-3">
            <div id="sidebar">
                <h3>Links</h3>
                <ul id="links">
                    <li><a href="https://github.com/dbolson">GitHub</a></li>
                    <li><a href="https://www.linkedin.com/in/dodevelopment">LinkedIn</a></li>
                    
                </ul>
                
                <div id="recent">
                    <h3>Recent Posts</h3>
                    <ul>
                        
                        <li><a href="/blog/posts/2014-07-17-how-to-set-up-a-service-oriented-architecture-for-development.html.html">How to Set up a Service Oriented Architecture for Development</a></li>
                        
                        <li><a href="/blog/posts/2014-03-22-what-do-you-get-when-you-send-an-engineer-to-poland-to-give-his-first-presentation.html.html">What Do You Get When You Send an Engineer to Poland to Give His First Presentation</a></li>
                        
                        <li><a href="/blog/posts/2014-02-06-notes-on-markdown.html.html">Notes on Markdown</a></li>
                        
                    </ul>
                </div>
                
                
                <div id="tags">
                    <h3>Tags</h3>
                    <ul>
                        
                        <li><a href="/blog/tags/mysql.html">mysql</a></li>
                        
                        <li><a href="/blog/tags/interviewing.html">interviewing</a></li>
                        
                        <li><a href="/blog/tags/testing.html">testing</a></li>
                        
                        <li><a href="/blog/tags/learning.html">learning</a></li>
                        
                        <li><a href="/blog/tags/tools.html">tools</a></li>
                        
                        <li><a href="/blog/tags/modularity.html">modularity</a></li>
                        
                        <li><a href="/blog/tags/conferences.html">conferences</a></li>
                        
                        <li><a href="/blog/tags/book review.html">book review</a></li>
                        
                        <li><a href="/blog/tags/encoding.html">encoding</a></li>
                        
                        <li><a href="/blog/tags/productivity.html">productivity</a></li>
                        
                        <li><a href="/blog/tags/sass.html">sass</a></li>
                        
                        <li><a href="/blog/tags/user interface.html">user interface</a></li>
                        
                        <li><a href="/blog/tags/metaldetectr.html">metaldetectr</a></li>
                        
                        <li><a href="/blog/tags/refactoring.html">refactoring</a></li>
                        
                        <li><a href="/blog/tags/rspec.html">rspec</a></li>
                        
                        <li><a href="/blog/tags/soa.html">soa</a></li>
                        
                        <li><a href="/blog/tags/ruby.html">ruby</a></li>
                        
                        <li><a href="/blog/tags/backbone.html">backbone</a></li>
                        
                        <li><a href="/blog/tags/bugs.html">bugs</a></li>
                        
                        <li><a href="/blog/tags/vim.html">vim</a></li>
                        
                        <li><a href="/blog/tags/speaking.html">speaking</a></li>
                        
                        <li><a href="/blog/tags/tests.html">tests</a></li>
                        
                        <li><a href="/blog/tags/markdown.html">markdown</a></li>
                        
                        <li><a href="/blog/tags/javascript.html">javascript</a></li>
                        
                        <li><a href="/blog/tags/pair programming.html">pair programming</a></li>
                        
                        <li><a href="/blog/tags/marionette.html">marionette</a></li>
                        
                        <li><a href="/blog/tags/jquery.html">jquery</a></li>
                        
                        <li><a href="/blog/tags/rails.html">rails</a></li>
                        
                        <li><a href="/blog/tags/open source.html">open source</a></li>
                        
                        <li><a href="/blog/tags/book reviews.html">book reviews</a></li>
                        
                        <li><a href="/blog/tags/design patterns.html">design patterns</a></li>
                        
                    </ul>
                </div>
                
            </div>
        </div>
    </div>
    <footer>Copyright &copy; 2015 Danny Olson
        <p style="text-align: center;">Powered by <a href="http://cryogenweb.org">Cryogen</a></p></footer>
</div>
<script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
<script src="../js/highlight.pack.js" type="text/javascript"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>
